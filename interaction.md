# Code Explainer API — дизайн взаимодействия

## Основной сценарий взаимодействия

### Основной путь пользователя
1. **Интерфейс ввода кода**: пользователь вставляет или вводит фрагменты кода в современный редактор с подсветкой синтаксиса.
2. **Выбор языка**: выпадающий список для выбора языка программирования (Python, JavaScript, Java, C++ и т. д.).
3. **Запрос объяснения**: кнопка «Объяснить код», отправляющая запрос к API.
4. **Состояние загрузки**: анимированный индикатор во время обработки кода моделью LLM.
5. **Отображение объяснения**: появляется форматированный ответ с:
   - построчным разбором;
   - объяснением ключевых концепций;
   - рекомендациями по лучшим практикам;
   - ссылками на смежные темы.

### Дополнительные возможности
1. **Панель истории**: боковая панель со списком прошлых объяснений и возможностью поиска/фильтрации.
2. **Избранные объяснения**: система отметок, чтобы сохранять важные ответы.
3. **Экспорт**: выгрузка объяснений в PDF или Markdown.
4. **Общий доступ**: генерация ссылок для обмена объяснениями.

## Интерактивные компоненты

### 1. Умный редактор кода
- **Возможности**: подсветка синтаксиса, автоотступы, нумерация строк.
- **Взаимодействие**: мгновенная валидация и подсветка ошибок.
- **Многоходовые запросы**: пользователь может менять код и запрашивать новое объяснение.

### 2. Настройка объяснений
- **Уровни сложности**: новичок, средний, продвинутый.
- **Фокусы анализа**: логика, синтаксис, лучшие практики, производительность.
- **Интерфейс**: переключатели и выпадающие списки.

### 3. Интерактивный просмотрщик объяснений
- **Сворачиваемые блоки**: раскрытие детализированных разделов.
- **Ссылки на код**: при наведении подсвечиваются соответствующие участки кода.
- **Интерактивные примеры**: встроенные исполняемые примеры.

### 4. Управление историей
- **Поиск и фильтрация**: по языку, дате, уровню сложности.
- **Теги**: добавление пользовательских тегов к объяснениям.
- **Массовые действия**: удаление нескольких элементов истории.

## Точки интеграции с API

### Основные эндпойнты
- `POST /code/explain` — отправка кода для объяснения.
- `GET /history/explanations` — получение истории объяснений.
- `GET /explanation/{id}` — получение конкретного объяснения.
- `POST /explanation/{id}/favorite` — добавление объяснения в избранное.

### Пользовательский поток
1. Пользователь вводит код и выбирает параметры.
2. Фронтенд валидирует данные и показывает индикатор загрузки.
3. Бэкенд обрабатывает запрос через LLM.
4. Объяснение сохраняется в базе данных.
5. Пользователь видит форматированный ответ.
6. Доступны действия: сохранить, поделиться, запросить уточнение.

## Обработка ошибок и особые случаи
- **Пустой код**: показываем подсказку о необходимости добавить код.
- **Неподдерживаемый язык**: предлагаем альтернативу или выдаём общее объяснение.
- **Ошибки API**: дружелюбные сообщения с возможностью повторить запрос.
- **Долгая обработка**: отображаем прогресс для сложных примеров.

## Доступность и удобство
- **Управление с клавиатуры**: полная поддержка навигации.
- **Экранные дикторы**: корректные ARIA-метки и описания.
- **Адаптивность**: интерфейс с поддержкой сенсорных устройств.
- **Тёмная/светлая тема**: возможность переключения оформления.